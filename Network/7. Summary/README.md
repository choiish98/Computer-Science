# "OSI 7 계층"

## 1. 데이터 링크 계층
### (1) MAC 계층
- **LAN 환경**에서는 네트워크의 자원을 효율적으로 활용하기 위해 데이터 링크 계층의 기능을 LLC 계층과 MAC 계층으로 나누어 처리한다. 
- 데이터 링크 계층의 기본 기능은 LLC 계층에서 다룬다.
- `물리적인 전송 선로의 특징과 매체 간의 연결 방식에 따른 제어` 부분은 **MAC 계층**에서 다룬다.
- 다중 접근 채널에서 데이터 전송의 **충돌**을 해결 하는 역할을 한다.
- **CSMA/CD**: `공유 버스` 방식의 데이터 전송을 이용하는 방식, `충돌을 허용`하는 방식, **허브/스위치** 방식을 이용한 LAN 케이블 구성
- **토큰 버스**: `물리적인 버스 구조이지만 논리적인 프레임 전달은 링 구조`, `토큰`을 통한 충돌 제어
- **토큰 링**: `순환 구조`의 링 인터페이스, `토큰`을 이용한 충돌 제어

### (2) LLC 계층
- 물리 계층을 통해 이루어지는 데이터 전송 과정에서의 **물리적인 전송 오류를 복구**하는 역할을 한다.
- 프레임 분실, 프레임 변형이라는 크게 두 가지의 오류를 **재전송**을 통해 해결
- **슬라이딩 윈도우 프로토콜**: `윈도우의 이동을 통한 흐름 제어 기능으로 물리적인 전송 오류를 해결`
  - **고백 N 방식**: 오류가 발생한 프레임 이후의 모든 정보 프레임을 재전송
  - **선택적 재전송 방식**: 오류가 발생한 프레임만 재전송
  - **피기배킹**: 응답 프레임과 정보 프레임을 동시에 전송하여 전송 횟수를 줄이는 방식
- **HDLC**: 호스트를 주국, 종국, 혼합국으로 구분하며 제어 프레임의 값에 따라 정보, 감독, 비번호 프레임으로 나뉘어 기능을 한다.
  - 세 가지 연결 모드: 정규 응답, 비동기 균형(LAPB), 비동기 응답(LAP)

## 2. 네트워크 계층
- 비연결형 서비스: 패킷이 서로 다른 경로를 통해 목적지 호스트로 전달하며, 신뢰성이 떨어지는 방식이다.
- 연결형 서비스: 상대적으로 신뢰성이 높은 서비스로, 패킷을 전송하기 전에 연결을 미리 설정하여 송신하는 방식
### (1) **라우팅**
- 송수신 호스트 사이의 `패킷 전달 경로를 선택하는 과정`
- 정적 라우팅: 패킷 전송이 이루어지기 전에 경로 정보를 라우터에 미리 저장
- 동적 라우팅: 경로 정보를 네트워크 상황에 따라 적절하게 변경하는 방식
- 라우팅 정보의 처리
  - 소스 라우팅: 패킷을 전송하는 호스트가 목적지 호스트까지 전달 경로를 스스로 결정하는 방식
  - 분산 라우팅: 라우팅 정보가 분산되는 방식으로 패킷의 전송 경로에 위치한 각 라우터가 효율적인 경로 선택에 참여
  - 중앙 라우팅: RCC라는 특별한 호스트를 사용해 전송 경로에 관한 모든 정보를 관리하는 방식
  - 계층 라우팅: 분산 라우팅 기능과 중앙 라우팅 기능을 적절히 조합하는 방식
- **라우팅 프로토콜**
  - 최단 경로 라우팅: 전송 패킷이 목적지까지 도착하는 여러 경로 중 가장 짧은 경로를 선택
  - 플러딩: 라우터가 자신에게 입력된 패킷을 출력 가능한 모든 경로로 중개하는 방식
  - 링크 벡터: 라우터와 직접 연결된 이웃 네트워크에 대한 연결 정보를 보관
  - 거리 벡터: 개별 네트워크들까지의 거리 정보를 관리 (ex) RIP 프로토콜
  - 다음 홈 벡터: 패킷을 전송하는 경로에 있는 다음 홉 정보를 관리
### (2) **혼잡 제어**
- `네트워크에 패킷 수가 과도하게 증가하는 현상을 예방하거나 제거`하는 기능. 흐름 제어와 달리 호스트와 라우터를 포함한 서브넷에서 네트워크의 전송 능력 문제를 다룬다.
- 트래픽 성형: 패킷의 발생 빈도가 네트워크에서 예측할 수 있는 전송률로 이루어지게 하는 기능 (ex) 리키 버킷
### (3) 패킷의 분할과 병합
- `큰 데이터를 여러 패킷으로 나누는 과정`을 분할이라 하고, 반대로 목적지에서 `분할된 패킷을 다시 모으는 과정`을 병합이라 한다. 패킷의 분할과 병합 과정이 양 끝단 시스템 사이에서 이루어지는 경우라면 전송 계층이 동작하는 종단 수신 시스템에 분할된 패킷을 보내고, 네트워크 계층에서 이루어지는 경우라면 중간의 각 라우터에서 분할과 병합을 반복한다.
### (4) IP 프로토콜
- 특징
  - 비연결형 서비스를 제공한다.
  - 패킷을 분할/병합하는 기능을 수행하기도 한다.
  - 데이터 체크섬은 제공하지 않고, 헤더 체크섬만 제공한다.
  - Best Effort 원칙에 따른 전송 기능을 제공한다.
- 헤더 구조
  - 혼잡 제어를 위한 필드: ECN
  - 패킷 분할을 위한 필드: Identification, DF, MF, Fragment Offset
  - 주소 관련 필드: Source Address, Destination Address
- **DHCP 프로토콜**: `할당 가능한 IP 주소`는 DHCP 서버가 관리하는 풀에 저장되어 관리되며, 클라이언트로부터 `IP 주소 요청이 오면 풀에서 하나의 IP 주소를 할당`, 사용이 끝나면 다시 IP 주소 풀로 반환
### (5) 기타 네트워크 프로토콜
- **IPv6**: IPv4의 주소 공간 부족 문제를 해결하기 위한 차세대 프로토콜이다.
  - 특징: 주소 공간 확장, 헤더 구조 단순화, 흐름 제어 기능 지원
  - 주소: IPv6에서는 16비트의 숫자 8개를 콜론으로 구분하여 표시 (ex) ```D1D1:1111:3F3F:1700:4545:1212:1111:1231```
- 이동 IP 프로토콜: `이동하는 사용자가 서비스 중단 없이 인터넷에 접속할 수 있는 이동 환경 서비스`를 수용하는 문제
  - **터널링**: 개별통신망 환경에서 사용하는 통신 규약을 **캡슐화/역캡슐화** 하여 가상의 터널을 형성하고 안전하게 데이터를 송수신 하는 기술
  - IP 터널링: 새로운 IP 주소를 할당하는 것과 호스트 고유의 주소를 유지하는 작업을 수행
- 기타 네트워크 계층 프로토콜
  - **ARP**: 수신 호스트의 IP 주소를 매개변수로 하여 수신 호스트의 MAC 주소 값을 얻음
  - **RARP**: MAC 주소를 이용해 IP 주소를 제공
  - **ICMP**: IP 패킷을 전송하는 과정에서 발생하는 문제를 보고, 라우터 혹은 다른 호스트들의 정보를 획득

## 3. 전송 계층
- 전송 계층은 네트워크 끝단에 위치하는 통신 주체가 중간의 `논리적인 선로`(라우터로 연결된 컴퓨터 네트워크)를 통해 데이터를 주고 받는다.
- 설계 시 고려 사항
  - 주소 표현: TCP/IP에서의 주소 표현은 IP 주소 + 포트 번호 방식으로 이루어진다. (ex) `192.168.0.1:80`
  - 멀티 플렉싱: `전송 연결 설정을 의미하는 포트에 다수의 가상 회선을 할당`하는 **하향식**과 이와 반대인 **상향식** 멀티 플렉싱이 있다.
  - 연결 설정 및 해제
### (1) 전송 계층의 주요 기능
- **흐름 제어**
- **오류 제어**: 데이터 변형이나 분실과 같은 오류에 대한 복구 절차
- **분할과 병합**: 전송을 요구한 데이터의 크기가 크면 데이터를 쪼개 전송해야 한다. 데이터를 전송하기 전에 `적합한 크기로 나누는 과정`을 분할이라 하고, `수신한 데이터를 원래 크기로 다시 모으는 과정`을 병합이라 한다.
- **서비스 프리미티브**: 사용자가 전송 계층 서비스를 사용하기 위한 인터페이스

### (2) TCP 프로토콜
- 인터넷에서 네트워크 계층의 기능을 제공하는 프로토콜은 IP이며, IP 프로토콜 위에서 실행되는 TCP는 연결형 서비스를 지원하는 프로토콜이다. TCP는 시스템 콜이라는 프로그램 호출 방식을 통해 사용한다.
- TCP 프로토콜 특징
  - `연결형 서비스`를 제공한다.
  - 전이중 방식의 `양방향` 가상 회선을 제공한다.
  - `신뢰성` 있는 데이터 전송을 보장한다.
- **포트 번호**: 포트 번호는 상위 계층에 제공하는 주소 표현 방식으로, 호스트 내의 `프로세스를 구분`하는 역할을 한다.
- 데이터 전송 과정
  - **연결 설정**: 송신 프로세스가 연결 설정을 요구하고 수신 프로세스는 응답을 회신한다. 이후 송신 프로세스는 응답이 제대로 도착했음을 알린다. 이때 전송할 데이터가 있으면, 데이터를 실어서 전송할 수 있다.
  - **데이터 전송**: TCP 데이터를 세그먼트라 부르며, 순서 번호와 함께 전송된다. 수신 프로세스는 데이터를 수신한 뒤 송신 프로세스에 응답 세그먼트를 전송한다. 전송할 데이터가 있으면 `응답 세그먼트에 데이터를 실어서 전송할 수 있다.` 오류가 발생하면 `타임아웃 기능에 의해 복구`된다.
  - **연결 해제**: 연결 해제는 `양쪽 프로세스의 동의 하에 진행`되기 때문에 연결 해제 세그먼트를 받은 프로세스가 응답할 때까지 연결은 유지된다.
- **혼잡 제어**
  - **ECN**: `라우터가 송신 프로세스에 명시적으로 혼잡 발생을 알려주어 송신 프로세스 스스로 트래픽을 완화하는 기술`
  - 연결 설정: TCP 연결 설정 단계에서 수신 프로세스와 ECN 기능을 사용할 것인지 협상
  - 동작 원리: 네트워크에 혼잡이 발생하면, 라우터는 수신 프로세스의 중개를 거쳐 간접적으로 송신 프로세스에 혼잡이 발생했음을 알린다. 혼잡을 인지한 송신 프로세스는 윈도우의 크기를 조절하여 전송되는 데이터의 양을 줄인다.

### (3) 기타 전송 프로토콜
- **UDP**: IP 프로토콜을 이용해 비연결형 서비스를 지원하는 UDP는 빠른 전송이 가능하다.
  - 특징
    - **비연결형** 서비스를 제공한다.
    - 헤더와 전송 데이터에 대한 체크섬 기능을 제공한다.
    - **Best Effort** 전달 방식을 지원한다.
  - 데이터그램 전송: 각 데이터그램은 전송 과정에서 `독립적으로 중개`한다. 데이터그램이 목적지까지 도착할 수 있도록 최선을 다하지만, 반드시 목적지에 도착하는 것을 보장하지 않는다. 오류 유형은 데이터그램 분실과 데이터그램의 도착 순서 변경이 있다.
- **RTP 프로토콜**
  - 실시간 멀티미디어 데이터 전송을 지원하는 프로토콜로 `UDP에 데이터그램 순서 번호 기능`을 추가한 방식이다.
  - 불규칙하게 수신되는 데이터의 순서를 정렬하기 위해 **타임스탬프 방식**을 사용 한다.
  - 응용 환경이 요구하는 알고리즘에 따라 버퍼 크기를 개별적으로 조절할 수 있다.  
  - 실시간 요구 사항
    - **버퍼**: 시간 간격이 가변적인 데이터를 수신 프로세스에 즉시 전송하지 않고, 지연 버퍼를 사용해 `데이터의 시간 간격을 일정하게 보정하여 전송`한다.
    - 지터: 데이터그램의 도착 시간을 측정하였을 때, 데이터그램의 도착 시간이 일정하지 않고 불규칙적으로 도착하는 정도
  - RTCP: RTP 제어 프로토콜로 다음 기능을 한다.
    - QOS와 혼잡제어
    - Identification
    - 세션 크기 조절
- OSI TP 프로토콜: OSI에서 정의한 전송 프로토콜로 연결형과 비연결형 서비스를 제공한다.

## 4. 상위 계층